# logging

В рамках стандартной библиотеки Python имеется библиотека `logging`. Данная библиотека предназначениа для выполнения логирования.

Логирование -- процесс ведения логов, т. е. записи сообщений о ходе работы приложения. Логи можно сравнить с рентгеновскими снимками выполнения программы. Чем детальнее логи, тем проще можно разрешать нестандартные ситуации.

Логирование особенно активно применяется при разработке веб-приложений в том числе и на FastAPI

Основными компонентами логирования с помощью библиотеки `logging` являются классы `Logger`, `Handler` и `Formatter`:

**Logger** -- объекты данного класса инициализируются с помощью метода `logging.getLogger()`, куда передается имя логгера. Данные объекты предоставляют наружу методы для записи сообщений разного уровня. Уровни необходимы для понимания контекста сообщений. `logging` поддерживает несколько уровней логирования:

* `DEBUG` -- отладочный уровень, полезный для разработчиков
* `INFO` -- уровень вспомогательной информации о ходе работы приложения
* `WAGNING` -- уровень предупреждения (например, таким образом можно предупреждать о том, что та или иная функция в приложении будет удалена)
* `ERROR` -- уровень ошибок (например, таким образом можно можно сообщать о недоступности внешнего сервиса)
* `CRITICAL` -- уровень критических ошибок, после которых работа приложения продолжаться не может

По умолчанию в `logging` задан уровень `WARNING`. Для задания необходимого уровня логирования можно воспользоваться методом `setLevel()` у объекта `Logging`

**Handler** -- объекты данного класса предназначены для управления обработкой записей сообщений, т. е. ни отвечают за то, куда будут записаны сообщения. В базовом наборе `logging`  предоставляет несколько готовых обработчиков:

* `SteamHandler` — записывает логи в поток, например, stdout или stderr.
* `FileHandler` — записывает логи в файл, класс имеет множество производных классов с различной функциональностью (ротация файлов логов по размеру, времени и т.д.)
* `SocketHandler` — записывает логи в сокет по TCP
* `DatagramHandler` — записывает логи в сокет по UDP
* `SysLogHandler` — записывает логи в syslog
* `HTTPHandler` — записывает логи по HTTP

Для указания конкретного обработчика необходимо у логгера вызвать метод `addHandler()` и передать в него объект обработчика. У одного логгера может быть несколько обработчиков

**Formatter** -- объекты данного класса отвечают за отображение сообщений, т. е. они отвечают за то, как будут записываться сообщения. Формат записи сообщений задается с помощью вызовы метода `setFormatter()` у логгера

В файле `logging_tools.py` реализована функция `configure_service_logger`, которая принимает объект конфигурации сервиса,  уровень логирования и название файлов, куда будут записываться логи

В данной функции инициализируется объект логгера, задается формат записи логов, устанавливается уровень логирования, задается обработчик для отображения сообщений в консоли и задается обработчик сохранения логов, если параметр `save_logs` конфигурацмии сервиса равен True

Для отображения логов в консоли используется `RichHandler`. Это класс библиотеки `rich`, которая предназначена для красочного форматирования текста в терминале

Для сохранения логов в файл используется модификация `FileHandler` -- `TimeRotatingFileHandler`. Он реализует следующий сценарий записи логов файл: по достижении полуночи все записанные логи за прошедшие сутки помещаются в отдельный файл
